<div class="create-container">
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
    </div>

    <div class="glass-form-card shadow-lg container">
        <header class="form-header">
            <div class="icon-circle"><mat-icon>edit_note</mat-icon></div>
            <h1 class="text-gradient">Refine Your Event</h1>
            <p>Update your event details to keep your audience informed.</p>
        </header>

        <form [formGroup]="form" (ngSubmit)="submit()">
            <div class="form-sections">
                <!-- Section 1: Essentials -->
                <div class="form-section">
                    <h3 class="section-title"><mat-icon>info</mat-icon> Core Information</h3>
                    <div class="form-grid-row">
                        <mat-form-field appearance="outline" class="flex-2">
                            <mat-label>Event Title</mat-label>
                            <input matInput formControlName="name">
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="flex-1">
                            <mat-label>Category</mat-label>
                            <mat-select formControlName="category">
                                <mat-option
                                    *ngFor="let cat of ['Music', 'Technology', 'Workshop', 'Conference', 'Travel', 'Health', 'Food', 'Art', 'Other']"
                                    [value]="cat">
                                    {{cat}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Description</mat-label>
                        <textarea matInput formControlName="description" rows="5"></textarea>
                    </mat-form-field>
                </div>

                <!-- Section 2: Logistics -->
                <div class="form-section">
                    <h3 class="section-title"><mat-icon>place</mat-icon> Logistics & Timing</h3>
                    <div class="form-grid-row">
                        <mat-form-field appearance="outline" class="flex-1">
                            <mat-label>Venue & Location</mat-label>
                            <input matInput formControlName="venue">
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="flex-1">
                            <mat-label>Date & Event Start</mat-label>
                            <input matInput type="datetime-local" formControlName="date_time">
                        </mat-form-field>
                    </div>
                </div>

                <!-- Section 3: Ticketing -->
                <div class="form-section">
                    <h3 class="section-title"><mat-icon>confirmation_number</mat-icon> Ticketing & Capacity</h3>
                    <div class="form-grid-row">
                        <mat-form-field appearance="outline" class="flex-1">
                            <mat-label>Guest Capacity</mat-label>
                            <input matInput type="number" formControlName="capacity" min="1">
                            <mat-icon matSuffix>group_add</mat-icon>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="flex-1">
                            <mat-label>Ticket Price (₹)</mat-label>
                            <input matInput type="number" formControlName="ticket_price" min="0">
                            <span matPrefix>₹&nbsp;</span>
                        </mat-form-field>
                    </div>
                </div>

                <!-- Section 4: Media -->
                <div class="form-section no-border">
                    <h3 class="section-title"><mat-icon>image</mat-icon> Update Media</h3>
                    <div class="upload-zone" [class.has-file]="preview">
                        <input type="file" (change)="onFile($event)" accept="image/*" style="display: none" #fileRef>

                        <div class="upload-content" *ngIf="!preview" (click)="fileRef.click()">
                            <mat-icon class="upload-icon">cloud_upload</mat-icon>
                            <p>Drag and drop your event banner or <span>browse files</span></p>
                            <span class="hint">Recommended: 1200 x 600px (JPG/PNG)</span>
                        </div>

                        <div class="preview-container" *ngIf="preview">
                            <img [src]="preview" alt="Event Banner">
                            <div class="preview-overlay">
                                <button mat-mini-fab color="warn" (click)="preview = null" type="button">
                                    <mat-icon>delete</mat-icon>
                                </button>
                                <button mat-mini-fab color="primary" (click)="fileRef.click()" type="button">
                                    <mat-icon>sync</mat-icon>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div *ngIf="progress !== null" class="upload-progress">
                <mat-progress-bar mode="determinate" [value]="progress"></mat-progress-bar>
                <span>Synchronizing artwork: {{progress}}%</span>
            </div>

            <div class="form-actions-v2">
                <button mat-button type="button" class="cancel-btn" (click)="cancel()">Discard Changes</button>
                <button mat-raised-button color="primary" type="submit" class="submit-btn"
                    [disabled]="form.invalid || submitting">
                    {{ submitting ? 'Saving Changes...' : 'Update Event' }}
                </button>
            </div>
        </form>
    </div>
</div>